***Context : Kernel***
core of an operating system, acting as a bridge between hardware and software, managing resources, and enabling applications to run smoothly and securely

TLDR:
- Protection : how can the OS perform special tasks and protect itself from applications?
	- [[#Privileged Instructions]] = only run in kernel mode, 
	- [[#Memory Protection]] = OS must protect itself as well as other programs 
 - Interactions With OS.. when/how does the OS run?
	 - [[#Events]] = change in control flow -> there are two types of events (interrupts, excep.):
		 -  [[#Interrupts]] = Signal external events, generated by hardware
			 Examples of external events
			 - [[#Interrupt Example Timer and I/0]]
		 - Exceptions = caused by program running instructions
			 Types of exceptions:
			 - [[#Exceptions System Calls]]
			 - [[#Exceptions Faults]]

![[Screenshot 2025-04-04 at 2.56.03 PM.png|450]]
## Protection
***Dual-Mode Operation***
-  How can OS perform special tasks such as managing resources? how can it protect itself from the applications and also protection applications from another?
	- ***OS NEEDS TO BE PRIVILEGED***
		- Every CPU core can run in Kernel mode or user mode
			- Kernel Mode: can run all instructions
			- User mode: only non-privileged instructions
			- Mode is indicated by a mode bit in a protected CPU control register

![[Screenshot 2025-04-04 at 3.07.23 PM.png|400]]
#### Privileged Instructions
- Privileged instructions: a subset of instructions that can only run in kernel mode
	- CPU checks mode bit when privileged instructions execute ▪ 
	- Attempts to execute in user mode are detected and prevented by the CPU 
- Privileged instructions can: 
	-  Directly access I/O devices (disk, network, etc.) » For security, fairness 
	-  Manipulate memory-management state (page table pointers, etc.) » Prevent apps from accessing other apps’ memory (or the OS’s memory) 
	-  Manipulate protected control registers (e.g., mode bit) » Prevent apps from giving themselves privileges!

#### Memory Protection
- OS must protect itself from user programs 
- OS must be able to protect programs from each other

## Interactions
## Events
![[Screenshot 2025-04-04 at 3.08.10 PM.png|400]]
![[Screenshot 2025-04-04 at 3.08.45 PM.png|400]]

-------
## Exceptions
A type of event, caused by program executing instructions
#### Exceptions : Faults
- Faults: Executing a privileged instruction, i.e. a fault which is a *type of exception*
![[Screenshot 2025-04-04 at 3.09.14 PM.png|400]]
![[Screenshot 2025-04-04 at 3.10.15 PM.png|400]]
#### Exceptions : System Calls
- System Calls Requesting services from OS, i.e. it is also a ***type of exception***
![[Screenshot 2025-04-04 at 3.11.04 PM.png|400]]
![[Screenshot 2025-04-04 at 3.11.27 PM.png|400]]
![[Screenshot 2025-04-04 at 3.12.01 PM.png|400]]
![[Screenshot 2025-04-04 at 3.12.23 PM.png|400]]

***Referencing Data***
Processes and the OS are in different address spaces 
▪ How can the OS return references to kernel data structures? 
	• Use names instead of pointers 
	▪ E.g., integer object handles or descriptors such as Unix file descriptors

----
## Interrupts
A type of event, generated by hardware / external 

![[Screenshot 2025-04-04 at 3.15.39 PM.png|450]]
![[Screenshot 2025-04-04 at 3.15.59 PM.png|450]]

#### Interrupt Example: Timer and I/0
![[Screenshot 2025-04-04 at 3.16.55 PM.png|400]]
![[Screenshot 2025-04-04 at 3.17.27 PM.png|400]]
![[Screenshot 2025-04-04 at 3.17.54 PM.png|400]]